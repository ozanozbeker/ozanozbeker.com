{
  "hash": "720acbf9cc190298d236b00b45b2aee5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"ggplot2: Elegant Graphics for Data Analysis (3e) | WIP\"\ndescription: \"Join me as I work through the book and apply my twist to it.\"\ndate: \"2024-05-06\"\nimage: ../resources/images/ggplot2_book_cover.jpg\ncategories: [\"R\", \"{ggplot2}\", \"Textbook Workthrough\"]\n---\n\n\n# Getting Started\n\n## 1 Introduction\n\nIn this post, I will be completing the exercises in [*ggplot2: Elegant Graphics for Data Analysis (3e)*](https://ggplot2-book.org/), the ultimate guide to [{ggplot2}](https://ggplot2.tidyverse.org/). I wanted to practice this textbook to better my knowledge of {ggplot2}, but also get a feel for the design behind the package, [*The Grammar of Graphics*](https://link.springer.com/book/10.1007/0-387-28695-0).\n\n> *\"Without a grammar, there is no underlying theory, so most graphics packages are a big collection of special cases.\"*\n\nI will not be re-iterating all of the information from the book, but provide a very brief summary and run through the exercises. Follow along to see my take on the exercises, as well as my notes and thoughts as I progress through the book.\n\n**Required Packages**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(c(\n  \"colorBlindness\", \"directlabels\", \"dplyr\", \"ggforce\", \"gghighlight\", \"ggnewscale\",\n  \"ggplot2\", \"ggraph\", \"ggtext\", \"ggthemes\", \"hexbin\", \"Hmisc\", \"mapproj\", \"maps\",\n  \"munsell\", \"ozmaps\", \"paletteer\", \"patchwork\", \"rmapshaper\", \"scico\", \"seriation\",\n  \"sf\", \"stars\", \"tidygraph\", \"tidyr\", \"wesanderson\"\n))\n```\n:::\n\n\n## 2 First Steps\n\n### 2.2 Fuel economy data\n\nIn this chapter, we will be using mostly one data set, `mpg`, from <http://fueleconomy.gov>. It holds information about the fuel economy of popular car models in 1999 & 2009.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nmpg\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 234 × 11\n   manufacturer model      displ  year   cyl trans drv     cty   hwy fl    class\n   <chr>        <chr>      <dbl> <int> <int> <chr> <chr> <int> <int> <chr> <chr>\n 1 audi         a4           1.8  1999     4 auto… f        18    29 p     comp…\n 2 audi         a4           1.8  1999     4 manu… f        21    29 p     comp…\n 3 audi         a4           2    2008     4 manu… f        20    31 p     comp…\n 4 audi         a4           2    2008     4 auto… f        21    30 p     comp…\n 5 audi         a4           2.8  1999     6 auto… f        16    26 p     comp…\n 6 audi         a4           2.8  1999     6 manu… f        18    26 p     comp…\n 7 audi         a4           3.1  2008     6 auto… f        18    27 p     comp…\n 8 audi         a4 quattro   1.8  1999     4 manu… 4        18    26 p     comp…\n 9 audi         a4 quattro   1.8  1999     4 auto… 4        16    25 p     comp…\n10 audi         a4 quattro   2    2008     4 manu… 4        20    28 p     comp…\n# ℹ 224 more rows\n```\n\n\n:::\n:::\n\n\nA quick overview of the variables:\n\n*   `cty` and `hwy` record miles per gallon (mpg) for city and highway driving.\n*   `displ` is the engine displacement in liters.\n*   `drv` is the drivetrain: front wheel (f), rear wheel (r), or four wheel.\n*   `model` is the model of car. There are 38 models, selected because they had a new edition every year between 1999 and 2008.\n*   `class` is a categorical variable describing the \"type\" of car: two seater, SUV, compact, etc.\n\n#### 2.2.1 Exercises\n\n1.  List five functions that you could use to get more information about the `mpg` dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhelp(mpg)\nglimpse(mpg)\nhead(mpg)\nstr(mpg)\nView(mpg)\n```\n:::\n\n\n2.  How can you find out what other datasets are included with {ggplot2}?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(package = 'ggplot2')\n```\n:::\n\n\n3.  Apart from the US, most countries use fuel consumption (fuel consumed over fixed distance) rather than fuel economy (distance traveled with fixed amount of fuel). How could you convert `cty` and `hwy` into the European standard of `l/100km`?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_to_euro = function(mpg) {\n  # 1 mile = 1.60934 kilometers\n  # 1 gallon (US) = 3.78541 liters\n  \n  g_p_m = 1 / mpg\n  l_p_km = 3.78541 / 1.60934    # we multiply by 100 because it's \"per 100\"\n  l100km = l_p_km * 100 * g_p_m # the denominator 100 cancels right hand 100\n  \n  return(l100km)\n}\n\nmpg |> mutate(cty_euro = us_to_euro(cty), hwy_euro = us_to_euro(hwy), .keep = 'used')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 234 × 4\n     cty   hwy cty_euro hwy_euro\n   <int> <int>    <dbl>    <dbl>\n 1    18    29     13.1     8.11\n 2    21    29     11.2     8.11\n 3    20    31     11.8     7.59\n 4    21    30     11.2     7.84\n 5    16    26     14.7     9.05\n 6    18    26     13.1     9.05\n 7    18    27     13.1     8.71\n 8    18    26     13.1     9.05\n 9    16    25     14.7     9.41\n10    20    28     11.8     8.40\n# ℹ 224 more rows\n```\n\n\n:::\n:::\n\n\n4.  Which manufacturer has the most models in this dataset? Which model has the most variations? Does your answer change if you remove the redundant specification of drivetrain (e.g. \"pathfinder 4wd\", \"a4 quattro\") from the model name?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpg |> count(manufacturer)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 15 × 2\n   manufacturer     n\n   <chr>        <int>\n 1 audi            18\n 2 chevrolet       19\n 3 dodge           37\n 4 ford            25\n 5 honda            9\n 6 hyundai         14\n 7 jeep             8\n 8 land rover       4\n 9 lincoln          3\n10 mercury          4\n11 nissan          13\n12 pontiac          5\n13 subaru          14\n14 toyota          34\n15 volkswagen      27\n```\n\n\n:::\n\n```{.r .cell-code}\nmpg |> count(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 38 × 2\n   model                  n\n   <chr>              <int>\n 1 4runner 4wd            6\n 2 a4                     7\n 3 a4 quattro             8\n 4 a6 quattro             3\n 5 altima                 6\n 6 c1500 suburban 2wd     5\n 7 camry                  7\n 8 camry solara           7\n 9 caravan 2wd           11\n10 civic                  9\n# ℹ 28 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\nmpg |> mutate(model_base = str_extract(model, \"^\\\\w+\")) |> count(model_base) # yes\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 35 × 2\n   model_base     n\n   <chr>      <int>\n 1 4runner        6\n 2 a4            15\n 3 a6             3\n 4 altima         6\n 5 c1500          5\n 6 camry         14\n 7 caravan       11\n 8 civic          9\n 9 corolla        5\n10 corvette       5\n# ℹ 25 more rows\n```\n\n\n:::\n:::\n\n\n### 2.3 Key Components\n\nEvery {ggplot2} plot has three key components:\n\n1.  **Data**,\n2.  A set of **aesthetic mappings** between variables in the data and visual properties, and\n3.  At least one layer which describes how to render each observation. Layers are usually created with a **geom** function.\n\nHere's a simple example:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy)) + geom_point()\n```\n\n::: {.cell-output-display}\n![](ggplot2_Elegant_Graphics_for_Data_Analysis_3e_files/figure-html/2.3 Example-1.png){width=672}\n:::\n:::\n\n\n#### 2.3.1 Exercises\n\n1.  **How would you describe the relationship between** `cty` **and** `hwy`**? Do you have any concerns about drawing conclusions from that plot?**\n\nThere is a strong positive linear relationship between city & highway gas mileage. Just plotting only those two might generalize too much across different classes of vehicles. Even though it may be true, maybe different classes of vehicles are more equal in city vs highway gas mileage vs performing substantially better in one or the other.\n\n2.  **What does** `ggplot(mpg, aes(model, manufacturer)) + geom_point()` **show? Is it useful? How could you modify that data to make it more informative?**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(model, manufacturer)) + geom_point()\n```\n\n::: {.cell-output-display}\n![](ggplot2_Elegant_Graphics_for_Data_Analysis_3e_files/figure-html/2.3.1 Question 1-1.png){width=672}\n:::\n:::\n\n\nThis plot just shows which manufacturers make which models. Having two categorical variables on a dot plot is not very useful as there is no inherent value in the relationship between two categories existing. Turning one category into a count() or other stat would show a dimensional relationship across the other category.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpg |> count(manufacturer) |> ggplot(aes(n, manufacturer)) + geom_point()\n```\n\n::: {.cell-output-display}\n![](ggplot2_Elegant_Graphics_for_Data_Analysis_3e_files/figure-html/2.3.1 Question 2-1.png){width=672}\n:::\n:::\n\n\n3.  **Describe the data, aesthetic mappings, and layers used for each of the following plots. You'll need to guess a little because you haven't seen all the datasets and functions yet, but use your common sense! See if you can predict what the plot will look like before running the code.**\n\n    1.  `ggplot(mpg, aes(cty, hwy)) + geom_point()` *A dot plot showing a positive relationship between city mpg and highway mpg.*\n    2.  `ggplot(diamonds, aes(carat, price)) + geom_point()` *A dot plot showing a positive relationship between diamond price and its carat rating.*\n    3.  `ggplot(economics, aes(date, unemploy)) + geom_line()` *A line plot showing unemployment rate across time.*\n    4.  `ggplot(mpg, aes(cty)) + geom_histogram()` *A histogram showing the distribution of cars across city mpg rating.*\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(cty, hwy)) + geom_point()\n```\n\n::: {.cell-output-display}\n![](ggplot2_Elegant_Graphics_for_Data_Analysis_3e_files/figure-html/2.3.1 Question 3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(diamonds, aes(carat, price)) + geom_point()\n```\n\n::: {.cell-output-display}\n![](ggplot2_Elegant_Graphics_for_Data_Analysis_3e_files/figure-html/2.3.1 Question 3-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(economics, aes(date, unemploy)) + geom_line()\n```\n\n::: {.cell-output-display}\n![](ggplot2_Elegant_Graphics_for_Data_Analysis_3e_files/figure-html/2.3.1 Question 3-3.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(mpg, aes(cty)) + geom_histogram()\n```\n\n::: {.cell-output-display}\n![](ggplot2_Elegant_Graphics_for_Data_Analysis_3e_files/figure-html/2.3.1 Question 3-4.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}